import{o as V,i as K,b as y,s as N}from"./lifecycle.Bxs-6lsY.js";import{l as k,n as O,c as R,f as D,a as w,p as F,b as G,h as i,g as t,m,k as C,u as J,d as U,e as z,r as M,t as W,o as q,w as I}from"./utils.g_h5GmmS.js";import{i as x}from"./if.B5JU9qyU.js";import{p as X}from"./props.pX2MipaD.js";import{s as Y,a as h}from"./config.BX3EyYwE.js";/* empty css                        */var Z=I('<svg class="w-5 h-5 icon-transition svelte-8vwu4q" fill="currentColor" viewBox="0 0 24 24"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z" class="svelte-8vwu4q"></path></svg>'),$=I('<svg class="w-5 h-5 icon-transition svelte-8vwu4q" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z" class="svelte-8vwu4q"></path></svg>'),tt=U('<button type="button"><div class="icon-container w-5 h-5 flex items-center justify-center relative svelte-8vwu4q"><!></div></button>');function rt(H,_){G(_,!1);let g=X(_,"currentLayout",12,"list"),l=m(!1),u=m(!1),d=m(!1),o=m("list"),n=null;const B=Y.responsive?.breakpoints?.desktop??1280;function T(e){typeof window<"u"&&window.dispatchEvent(new CustomEvent("layoutChange",{detail:{layout:e}}))}function b(e){sessionStorage.setItem("postListLayout",e),localStorage.setItem("postListLayout",e)}function S(){return sessionStorage.getItem("postListLayout")}function j(){if(!t(l)||t(u)||t(d))return;i(d,!0);const e=t(o)==="list"?"grid":"list";i(o,e),b(e)}function A(){i(d,!1)}function f(e){i(u,!e.matches)}V(()=>{i(l,!0);const e=S(),a=h.postListLayout.defaultMode;e==="list"||e==="grid"?(i(o,e),localStorage.getItem("postListLayout")!==e&&localStorage.setItem("postListLayout",e)):(i(o,a),b(a)),n=window.matchMedia(`(min-width: ${B}px)`),f(n),n.addEventListener?n.addEventListener("change",f):n.addListener(f);const c=s=>{s.detail?.layout&&i(o,s.detail.layout)},r=()=>{setTimeout(()=>{const s=S();s==="list"||s==="grid"?i(o,s):i(o,h.postListLayout.defaultMode)},200)};window.addEventListener("layoutChange",c);const p=()=>{const s=window.swup;s?.hooks?(s.hooks.on("content:replace",r),s.hooks.on("page:view",r)):window.addEventListener("popstate",r)};return window.swup?p():setTimeout(p,200),()=>{n&&(n.removeEventListener?n.removeEventListener("change",f):n.removeListener(f)),window.removeEventListener("layoutChange",c),window.removeEventListener("popstate",r);const s=window.swup;s?.hooks&&(s.hooks.off("content:replace",r),s.hooks.off("page:view",r))}}),k(()=>(t(u),t(o)),()=>{g(t(u)?"list":t(o))}),k(()=>(t(l),C(g())),()=>{t(l)&&T(g())}),O(),K();var E=R(),P=D(E);{var Q=e=>{var a=tt(),c=z(a),r=z(c);{var p=v=>{var L=Z();w(v,L)},s=v=>{var L=$();w(v,L)};x(r,v=>{t(o)==="list"?v(p):v(s,!1)})}M(c),M(a),W(()=>{y(a,"aria-label",t(o)==="list"?"切换到网格模式":"切换到列表模式"),y(a,"aria-pressed",t(o)==="grid"),N(a,1,`btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 flex items-center justify-center theme-switch-btn ${t(d)?"switching":""}`,"svelte-8vwu4q"),a.disabled=t(d),y(a,"title",t(o)==="list"?"切换到网格模式":"切换到列表模式")}),q("animationend",c,A),q("click",a,j),w(e,a)};x(P,e=>{t(l),C(h),t(u),J(()=>t(l)&&h.postListLayout.allowSwitch&&!t(u))&&e(Q)})}w(H,E),F()}export{rt as default};
